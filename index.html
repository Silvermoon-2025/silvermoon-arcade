<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>银月的游戏咖厅</title>
    <link rel="icon" href="历史爱好者爱好者服务专设网站（网页图标）.ico" type="image/x-icon">
    <link rel="shortcut icon" href="历史爱好者服务专设网站（网页图标）.ico" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
extend: {
    colors: {
        primary: '#165DFF',
        secondary: '#FFD166',
        neutral: '#F5F7FA',
        board: '#E6C388',
        black: '#000001',
        white: '#FFFFFF',
        nightBackground: '#121212',
        nightBoard: '#332a1b',
        nightText: '#e0e0e0',
        nightBlock: '#364969'
    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
/* 优化夜间模式下的游戏状态区域 */
body.dark-mode .flex.justify-between.items-center.mb-4.px-4.py-3.bg-white.rounded-lg.shadow-sm {
    background-color: theme('colors.nightBlock');
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* 优化夜间模式下的游戏信息卡片 - 正确的选择器 */
body.dark-mode .flex.flex-col.md\:flex-row.justify-center.items-center.space-y-6.md\:space-y-0.md\:space-x-6 > div:last-child.w-full.md\:w-64.bg-white.rounded-lg.shadow-lg.p-4 {
    background-color: theme('colors.nightBlock') !important;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* 调整游戏信息卡片内的文本和边框颜色 */
body.dark-mode .border-b.border-gray-200 {
    border-color: rgba(255, 255, 255, 0.1);
}

body.dark-mode .text-gray-600 {
    color: rgba(255, 255, 255, 0.7);
}

/* 调整游戏规则列表项颜色 */
body.dark-mode .text-sm.text-gray-600.space-y-1 li {
    color: rgba(255, 255, 255, 0.8);
}

@layer utilities {
    .content-auto {
        content-visibility: auto;
    }
    
    .board-grid {
        background-image: linear-gradient(to right, theme('colors.black') 1px, transparent 1px),
                          linear-gradient(to bottom, theme('colors.black') 1px, transparent 1px);
    }
}

body.dark-mode {
    background-color: theme('colors.nightBackground');
    color: theme('colors.nightText');
}

body.dark-mode .text-gray-600,
body.dark-mode .text-gray-700,
body.dark-mode .text-gray-800 {
    color: theme('colors.nightText');
}

body.dark-mode .game-status-container,
body.dark-mode .game-info-card {
    background-color: theme('colors.nightBlock');
    color: theme('colors.nightText');
}

body.dark-mode .btn-primary {
    background-color: theme('colors.primary');
    color: white;
}

body.dark-mode .btn-secondary {
    background-color: theme('colors.secondary');
    color: theme('colors.primary');
}

body.dark-mode header {
    background-color: #165DFF;
}

body.dark-mode .text-black {
    color: theme('colors.nightText');
}

/* 反应游戏样式 */
.game-container {
    position: relative;
    width: 100%;
    height: 500px;
    border: 2px solid #333;
    border-radius: 8px;
    overflow: hidden;
    background-color: #f0f0f0;
}

/* 夜间模式下的游戏容器背景 */
body.dark-mode .game-container {
    background-color: #1e1e1e;
    border-color: #444;
}

/* 夜间模式下的问题显示区域 */
body.dark-mode #question {
    background-color: rgba(255, 255, 255, 0.05);
    color: theme('colors.nightText');
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* 修改判定线样式，只保留一条线 */
.target-line {
    position: absolute;
    height: 4px;
    width: 100%;
    top: 70%;
    background-color: #ff3e3e;
    z-index: 10;
    box-shadow: 0 0 10px rgba(255, 62, 62, 0.7);
}

.falling-block {
    position: absolute;
    width: 50px;
    height: 50px;
    background-color: #165DFF;
    border-radius: 4px;
    transition: transform 0.1s linear;
}

/* 夜间模式下方块样式 */
body.dark-mode .falling-block {
    background-color: theme('colors.nightBlock');
    border: 1px solid rgba(255, 255, 255, 0.2);
}

/* 方块接近判定线时的视觉反馈 */
.falling-block.near-target {
    background-color: #4CAF50;
}

/* 夜间模式下方块接近判定线的视觉反馈 */
body.dark-mode .falling-block.near-target {
    background-color: #388E3C;
}

.control-button {
    background-color: #FFD166;
    color: #165DFF;
    border: none;
    border-radius: 8px;
    padding: 15px 30px;
    font-size: 1.2rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
}

.control-button:hover {
    transform: scale(1.05);
    background-color: #ffc433;
}

.life-icon {
    color: #ff3e3e;
    font-size: 1.5rem;
    margin: 0 5px;
}

/* 游戏结束遮罩样式 */
.game-over-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 100;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.game-over-overlay.active {
    opacity: 1;
    visibility: visible;
}

.game-over-content {
    background-color: white;
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    max-width: 400px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

body.dark-mode .game-over-content {
    background-color: theme('colors.nightBlock');
    color: theme('colors.nightText');
}

.game-over-score {
    font-size: 2rem;
    font-weight: bold;
    color: #165DFF;
    margin: 15px 0;
}

body.dark-mode .game-over-score {
    color: #FFD166;
}

.restart-button {
    background-color: #165DFF;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 24px;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
    margin-top: 20px;
}

.restart-button:hover {
    background-color: #0047CC;
    transform: scale(1.05);
}

/* 夜间模式下的控制按钮样式 */
body.dark-mode .control-button {
    background-color: theme('colors.secondary');
    color: theme('colors.primary');
}

body.dark-mode .control-button:hover {
    background-color: #ffc433;
}

/* 夜间模式下答题选项按钮样式 */
body.dark-mode .option-btn {
    background-color: #2d3748; /* 深灰色背景 */
    color: theme('colors.nightText');
    border: 1px solid rgba(255, 255, 255, 0.1);
}

body.dark-mode .option-btn:hover {
    background-color: #4a5568; /* 稍亮的灰色 */
}

body.dark-mode .option-btn.selected {
    background-color: #364969; /* 选中时使用主题色 */
    color: white;
    border-color: theme('colors.primary');
}

body.dark-mode .option-btn.correct {
    background-color: #38a169; /* 绿色表示正确答案 */
    color: white;
}

body.dark-mode .option-btn.incorrect {
    background-color: #e53e3e; /* 红色表示错误答案 */
    color: white;
}
</style>
</head>
<body class="bg-neutral min-h-screen font-sans text-black">
    <!-- 顶部导航栏 -->
    <header class="bg-primary text-white shadow-lg">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center mb-4 md:mb-0">
                <a href="https://silvermoon-2025.github.io/historyloverweb/" class="flex items-center hover:opacity-90 transition-opacity">
                    <i class="fa fa-book text-2xl mr-2"></i>
                    <span class="text-xl font-bold">历史爱好者服务专设网站</span>
                </a>
            </div>
            <div class="flex items-center space-x-2">
                <i class="fa fa-gamepad text-secondary text-2xl"></i>
                <h1 class="text-xl md:text-2xl font-bold tracking-tight">银月的游戏咖厅</h1>
            </div>
            <button onclick="toggleMusic()" style="position:fixed; bottom:6rem; right:1.5rem; width:3rem; height:3rem; border-radius:50%; background:white; border:2px solid #3b82f6; cursor:pointer; z-index:999;">
              <i id="musicIcon" class="fa fa-music" style="color:#3b82f6; font-size:1.2rem;"></i>
            </button>
            <button id="theme-toggle" class="fixed bottom-6 right-6 w-32 h-14 rounded-full border-2 border-yellow-400 shadow-lg overflow-hidden transition-all duration-300 ease-in-out z-50 cursor-pointer hover:scale-105 active:scale-95">
                <div class="relative w-full h-full overflow-hidden">
                    <div id="day-bg" class="absolute inset-0 bg-blue-100 transition-opacity duration-500 ease-in-out">
                        <div class="absolute top-3 left-2 w-12 h-4 bg-white rounded-full"></div>
                        <div class="absolute top-5 left-7 w-10 h-4 bg-white rounded-full"></div>
                        <div class="absolute top-3 right-2 w-12 h-4 bg-white rounded-full"></div>
                        <div class="absolute top-5 right-7 w-10 h-4 bg-white rounded-full"></div>
                    </div>
                    <div id="night-bg" class="absolute inset-0 bg-black opacity-0 transition-opacity duration-500 ease-in-out">
                        <div class="absolute top-3 left-3 w-1 h-1 bg-yellow-300 rounded-full animate-pulse"></div>
                        <div class="absolute top-6 left-8 w-1.5 h-1.5 bg-yellow-300 rounded-full animate-pulse" style="animation-delay: 0.5s"></div>
                        <div class="absolute top-4 left-12 w-1 h-1 bg-yellow-300 rounded-full animate-pulse" style="animation-delay: 1s"></div>
                        <div class="absolute bottom-3 left-5 w-1.5 h-1.5 bg-yellow-300 rounded-full animate-pulse" style="animation-delay: 1.5s"></div>
                        <div class="absolute bottom-5 left-10 w-1 h-1 bg-yellow-300 rounded-full animate-pulse" style="animation-delay: 2s"></div>
                    </div>
                    <div id="toggle-icon" class="absolute top-1 w-12 h-12 rounded-full transition-transform duration-700 ease-in-out transform">
                        <div id="sun" class="absolute inset-0 w-full h-full bg-yellow-400 rounded-full shadow-lg shadow-yellow-400/50 transition-opacity duration-300 ease-in-out">
                            <div class="absolute inset-0 flex items-center justify-center">
                                <div class="absolute w-14 h-1.5 bg-yellow-400 rounded-full"></div>
                                <div class="absolute w-1.5 h-14 bg-yellow-400 rounded-full"></div>
                                <div class="absolute w-10 h-1.5 bg-yellow-400 rounded-full transform rotate-45"></div>
                                <div class="absolute w-1.5 h-10 bg-yellow-400 rounded-full transform rotate-45"></div>
                            </div>
                        </div>
                        <div id="moon" class="absolute inset-0 w-full h-full bg-gray-200 rounded-full shadow-lg opacity-0 transition-opacity duration-300 ease-in-out">
                            <div class="absolute top-2 left-2 w-2 h-2 bg-gray-300 rounded-full"></div>
                            <div class="absolute top-4 right-3 w-1.5 h-1.5 bg-gray-300 rounded-full"></div>
                            <div class="absolute bottom-3 left-3 w-2.5 h-2.5 bg-gray-300 rounded-full"></div>
                        </div>
                    </div>
                </div>
            </button>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="container mx-auto px-4 py-8 max-w-5xl">
        <div class="text-center mb-8">
            <p class="text-lg font-medium">开放时间</p>
            <p class="text-xs text-gray-600">Open Time</p>
            <p class="text-sm">2026年1月10日 - 2025年2月14日</p>
        </div>

        <div class="max-w-md mx-auto mb-8 relative">
          <div class="bg-white dark:bg-blue-700 rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 border border-gray-100 dark:border-gray-700">
            <div class="flex items-center justify-between mb-4 pb-3 border-b border-gray-100 dark:border-gray-700">
              <h3 class="text-lg font-bold text-gray-800 dark:text-white flex items-center">
                <span class="w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center mr-2">
                  <i class="fa fa-music text-blue-600 dark:text-blue-400 text-sm"></i>
                </span>
                【站嵌音乐】
              </h3>
              <span class="text-xs px-2 py-1 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
                音乐信息
              </span>
            </div>
            <div class="grid grid-cols-1 gap-3 text-sm">
              <div class="flex items-center">
                <span class="w-28 text-gray-500 dark:text-gray-400">绑定时间：</span>
                <span class="text-gray-800 dark:text-gray-200 font-medium">2026年1月10日</span>
              </div>
              <div class="flex items-center">
                <span class="w-28 text-gray-500 dark:text-gray-400">绑定音乐：</span>
                <span class="text-gray-800 dark:text-gray-200 font-medium">Beatrix - Ilan Eshkeri</span>
              </div>
              <div class="flex items-center">
                <span class="w-28 text-gray-500 dark:text-gray-400">续播时间：</span>
                <span class="text-gray-800 dark:text-gray-200 font-medium">2026年1月10日~2025年2月14日</span>
              </div>
            </div>
          </div>
          <div class="absolute -bottom-2 -right-2 w-12 h-12 bg-gradient-to-br from-blue-400 to-purple-500 rounded-lg opacity-20 dark:opacity-30"></div>
        </div>

        <div class="text-center mb-8">
            <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-primary mb-2">日耳曼古今见解测试</h2>
            <p class="text-gray-600 max-w-2xl mx-auto">回答关于德国历史的问题，测试你对普鲁士王国到现代德国的了解程度！</p>
        </div>

        <div class="flex justify-between items-center mb-4 px-4 py-3 bg-white rounded-lg shadow-sm">
            <div class="flex items-center">
                <span id="game-status" class="font-medium">点击开始游戏</span>
            </div>
            <div class="flex items-center">
                <span class="mr-2">生命:</span>
                <div id="lives-container">
                    <i class="fa fa-heart life-icon"></i>
                    <i class="fa fa-heart life-icon"></i>
                    <i class="fa fa-heart life-icon"></i>
                </div>
            </div>
            <div class="flex space-x-2">
                <button id="start-btn" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 flex items-center">
                    <i class="fa fa-play mr-2"></i> 开始游戏
                </button>
                <button id="restart-btn" class="bg-secondary hover:bg-opacity-90 text-primary px-4 py-2 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 flex items-center">
                    <i class="fa fa-refresh mr-2"></i> 重新开始
                </button>
            </div>
        </div>

        <div class="flex flex-col md:flex-row justify-center items-center space-y-6 md:space-y-0 md:space-x-6">
            <div class="game-container bg-white shadow-xl rounded-lg">
                <!-- 问题显示区域 -->
                <div class="h-full flex flex-col p-4">
                    <div id="question" class="text-lg font-medium mb-4 p-4 text-center min-h-[60px] flex items-center justify-center">
                        点击开始游戏以开始答题
                    </div>
                    <div id="options" class="grid grid-cols-1 gap-3 p-4">
                        <!-- 选项将通过JavaScript动态生成 -->
                    </div>
                </div>
                <!-- 游戏结束遮罩 -->
                <div id="game-over-overlay" class="game-over-overlay">
                    <div class="game-over-content">
                        <h3 class="text-xl font-bold">游戏结束</h3>
                        <p class="text-gray-700 dark:text-gray-300 mb-2">您的得分: <span id="final-score">0</span></p>
                        <p class="text-gray-700 dark:text-gray-300 mb-2">正确答案数: <span id="correct-answers">0</span>/<span id="total-questions">0</span></p>
                        <p class="text-gray-700 dark:text-gray-300">准确率: <span id="accuracy-rate">0</span>%</p>
                        <button id="play-again-btn" class="restart-button">
                            <i class="fa fa-refresh mr-2"></i> 重新再来
                        </button>
                    </div>
                </div>
            </div>

            <div class="w-full md:w-64 bg-white rounded-lg shadow-lg p-4">
                <h3 class="text-lg font-semibold mb-3 pb-2 border-b border-gray-200">游戏信息</h3>
                
                <div class="mb-4">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">当前分数</span>
                        <span id="score" class="font-medium">0</span>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h4 class="font-medium mb-2">游戏规则</h4>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li>• 系统会随机显示德国历史相关问题</li>
                        <li>• 从四个选项中选择一个正确答案</li>
                        <li>• 答错会扣除一条命</li>
                        <li>• 共有3条命，用完游戏结束</li>
                        <li>• 答对题目可获得分数</li>
                    </ul>
                </div>
                
                <div class="mt-6">
                    <button id="action-btn" class="control-button w-full" disabled style="display:none;">
                        <i class="fa fa-hand-pointer-o mr-2"></i> 点击判定
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-primary text-white mt-12 py-6">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p class="text-lg font-semibold">银月的游戏咖厅</p>
                    <p class="text-sm text-white/80 mt-1">本网站仅供娱乐消遣而用</p>
                </div>
                <div class="text-right">
                    <p class="text-sm">
                        [发布地] 中国-北京<br>
                        [网站创建时间] 2025年7月5日<br>
                        [网页名称] 银月的游戏咖厅<br>
                        [特别鸣谢] 我不是徐某人（QQ）
                    </p>
                </div>
            </div>
            <div class="mt-6 pt-4 border-t border-white/20 text-center text-sm text-white/70">
                <p>© 2025-2026 银月的游戏咖厅</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 德国历史题目数据
            const questions = [
                {
                    question: "普鲁士王国的第一位国王是谁？",
                    options: ["腓特烈·威廉一世", "腓特烈一世", "腓特烈大帝", "腓特烈·威廉三世"],
                    answer: 1
                },
                {
                    question: "哪位普鲁士国王被称为'腓特烈大帝'？",
                    options: ["腓特烈一世", "腓特烈·威廉一世", "腓特烈二世", "腓特烈三世"],
                    answer: 2
                },
                {
                    question: "普鲁士在哪个战争中崛起为欧洲大国？",
                    options: ["三十年战争", "七年战争", "拿破仑战争", "普法战争"],
                    answer: 1
                },
                {
                    question: "德意志帝国成立于哪一年？",
                    options: ["1867年", "1871年", "1875年", "1880年"],
                    answer: 1
                },
                {
                    question: "谁是德意志帝国的第一任宰相？",
                    options: ["俾斯麦", "毛奇", "罗恩", "威廉一世"],
                    answer: 0
                },
                {
                    question: "第一次世界大战德国战败后签订了哪个条约？",
                    options: ["凡尔赛条约", "布列斯特-立陶夫斯克条约", "圣日耳曼条约", "纳伊条约"],
                    answer: 0
                },
                {
                    question: "魏玛共和国成立于哪一年？",
                    options: ["1918年", "1919年", "1920年", "1921年"],
                    answer: 1
                },
                {
                    question: "希特勒于哪一年成为德国总理？",
                    options: ["1932年", "1933年", "1934年", "1935年"],
                    answer: 1
                },
                {
                    question: "纳粹党在德语中的全称是什么？",
                    options: ["国家社会主义党", "德国工人党", "国家社会主义德国工人党", "民族社会主义党"],
                    answer: 2
                },
                {
                    question: "第二次世界大战欧洲战场以德国投降告终是在哪一年？",
                    options: ["1944年", "1945年", "1946年", "1947年"],
                    answer: 1
                },
                {
                    question: "柏林墙是在哪一年开始建造的？",
                    options: ["1959年", "1961年", "1963年", "1965年"],
                    answer: 1
                },
                {
                    question: "东西德统一是在哪一年？",
                    options: ["1989年", "1990年", "1991年", "1992年"],
                    answer: 1
                },
                {
                    question: "德国统一后的首都是哪里？",
                    options: ["汉堡", "慕尼黑", "柏林", "法兰克福"],
                    answer: 2
                },
                {
                    question: "德国的《基本法》（宪法）是在哪一年制定的？",
                    options: ["1948年", "1949年", "1950年", "1951年"],
                    answer: 1
                },
                {
                    question: "普鲁士王国的首都最初是哪里？",
                    options: ["柏林", "波茨坦", "柯尼斯堡", "德累斯顿"],
                    answer: 0
                },
                {
                    question: "德意志帝国的皇帝被称为？",
                    options: ["凯撒", "沙皇", "德皇", "皇帝"],
                    answer: 0
                },
                {
                    question: "哪位普鲁士国王主持了铁血演说？",
                    options: ["腓特烈大帝", "威廉一世", "俾斯麦", "威廉二世"],
                    answer: 2
                },
                {
                    question: "第一次世界大战爆发的直接导火索是什么事件？",
                    options: ["萨拉热窝事件", "七月危机", "奥匈帝国对塞尔维亚宣战", "德国对俄国宣战"],
                    answer: 0
                },
                {
                    question: "魏玛共和国得名于？",
                    options: ["一个政治党派", "制宪会议召开的地点", "宪法签署的日期", "一位政治家的名字"],
                    answer: 1
                },
                {
                    question: "希特勒在啤酒馆政变失败后被监禁期间写了哪本书？",
                    options: ["《我的奋斗》", "《德意志民族》", "《国家社会主义》", "《德国复兴》"],
                    answer: 0
                },
                {
                    question: "第二次世界大战中德国入侵苏联的行动代号是什么？",
                    options: ["巴巴罗萨计划", "海狮计划", "闪电计划", "台风计划"],
                    answer: 0
                },
                {
                    question: "冷战时期，德国分裂为哪两个国家？",
                    options: ["东德和西德", "联邦德国和民主德国", "德意志联邦共和国和德意志民主共和国", "以上都是"],
                    answer: 3
                },
                {
                    question: "柏林墙倒塌发生在哪一年？",
                    options: ["1988年", "1989年", "1990年", "1991年"],
                    answer: 1
                },
                {
                    question: "德国联邦总理的官邸位于哪里？",
                    options: ["柏林", "波恩", "慕尼黑", "汉堡"],
                    answer: 0
                },
                {
                    question: "德国统一后，原东德地区被称为？",
                    options: ["新联邦州", "东部地区", "前民主德国", "东德州"],
                    answer: 0
                }
            ];
            
            // 游戏常量
            const MAX_LIVES = 3;
            
            // 游戏状态
            let score = 0;
            let lives = MAX_LIVES;
            let gameActive = false; // 初始状态设置为未开始
            let currentQuestionIndex = 0;
            let currentQuestion = null;
            let answered = false;
            let answeredCorrectly = false;
            let questionsUsed = [];
            let totalQuestionsAnswered = 0; // 总答题数
            let correctAnswers = 0;         // 正确答案数
            let gameLoop;                   // 游戏循环（保留以避免错误，但不再使用）
            
            // DOM元素
            const gameContainer = document.querySelector('.game-container');
            const actionButton = document.getElementById('action-btn');
            const startButton = document.getElementById('start-btn');
            const restartButton = document.getElementById('restart-btn');
            const playAgainButton = document.getElementById('play-again-btn');
            const scoreElement = document.getElementById('score');
            const gameStatusElement = document.getElementById('game-status');
            const livesContainer = document.getElementById('lives-container');
            const gameOverOverlay = document.getElementById('game-over-overlay');
            const finalScoreElement = document.getElementById('final-score');
            const questionElement = document.getElementById('question');
            const optionsContainer = document.getElementById('options');
            
            // 开始游戏
            function startGame() {
                // 重置游戏状态
                score = 0;
                lives = MAX_LIVES;
                gameActive = true;
                questionsUsed = [];
                answered = false;
                answeredCorrectly = false;
                
                // 更新UI
                updateScore();
                updateLives();
                gameStatusElement.textContent = `当前分数: ${score}`;
                actionButton.disabled = true;
                startButton.disabled = true;
                
                // 隐藏游戏结束遮罩
                gameOverOverlay.classList.remove('active');
                
                // 重置统计信息显示
                updateStats();
                
                // 重置统计信息显示
                updateStats();
                
                // 显示第一题
                showNextQuestion();
            }
            
            // 重新开始（重置后默认暂停）
            function resetGame() {
                // 停止游戏
                gameActive = false;
                
                // 重置游戏状态
                score = 0;
                lives = MAX_LIVES;
                questionsUsed = [];
                answered = false;
                answeredCorrectly = false;
                totalQuestionsAnswered = 0;
                correctAnswers = 0;
                
                // 更新UI为暂停状态
                updateScore();
                updateLives();
                gameStatusElement.textContent = `点击开始游戏`;
                actionButton.disabled = true;
                startButton.disabled = false;
                
                // 清空问题显示区域
                const questionElement = document.getElementById('question');
                const optionsContainer = document.getElementById('options');
                questionElement.textContent = '点击开始游戏以开始答题';
                optionsContainer.innerHTML = '';
                
                // 隐藏游戏结束遮罩
                gameOverOverlay.classList.remove('active');
                
                // 重置统计信息显示
                updateStats();
            }
            
            // 显示下一题
            function showNextQuestion() {
                if (!gameActive) return;
                
                // 检查是否还有未使用的问题
                if (questionsUsed.length >= questions.length) {
                    // 如果所有问题都用完了，重新开始
                    questionsUsed = [];
                }
                
                // 随机选择一个未使用过的问题
                let randomIndex;
                do {
                    randomIndex = Math.floor(Math.random() * questions.length);
                } while (questionsUsed.includes(randomIndex));
                
                questionsUsed.push(randomIndex);
                currentQuestion = questions[randomIndex];
                currentQuestionIndex = randomIndex;
                
                // 显示问题和选项
                displayQuestion(currentQuestion);
            }
            
            // 显示问题和选项
            function displayQuestion(questionObj) {
                const questionElement = document.getElementById('question');
                const optionsContainer = document.getElementById('options');
                
                questionElement.textContent = questionObj.question;
                
                // 清空选项容器
                optionsContainer.innerHTML = '';
                
                // 创建选项按钮
                questionObj.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.className = 'w-full bg-gray-100 hover:bg-gray-200 text-left p-3 rounded-lg transition-colors duration-200 option-btn border border-transparent';
                    button.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                    button.onclick = () => selectOption(index);
                    optionsContainer.appendChild(button);
                });
                
                answered = false;
            }
            
            // 选择选项
            function selectOption(selectedIndex) {
                if (answered || !gameActive) return;
                
                answered = true;
                
                const optionsContainer = document.getElementById('options');
                const optionButtons = optionsContainer.querySelectorAll('.option-btn');
                
                // 检查答案是否正确
                const isCorrect = selectedIndex === currentQuestion.answer;
                
                // 高亮选中的选项
                optionButtons[selectedIndex].classList.remove('bg-gray-100', 'hover:bg-gray-200');
                if (isCorrect) {
                    optionButtons[selectedIndex].classList.add('bg-green-500', 'text-white');
                } else {
                    optionButtons[selectedIndex].classList.add('bg-red-500', 'text-white');
                }
                
                // 高亮正确答案
                if (!isCorrect) {
                    optionButtons[currentQuestion.answer].classList.remove('bg-gray-100', 'hover:bg-gray-200');
                    optionButtons[currentQuestion.answer].classList.add('bg-green-500', 'text-white');
                }
                
                // 记录答题统计
                totalQuestionsAnswered++;
                if (isCorrect) {
                    // 答对了加分
                    score += 10;
                    updateScore();
                    gameStatusElement.textContent = `正确! +10分`;
                    answeredCorrectly = true;
                    correctAnswers++;
                } else {
                    // 答错了扣生命值
                    loseLife();
                    gameStatusElement.textContent = `错误! 正确答案是: ${currentQuestion.options[currentQuestion.answer]}`;
                    answeredCorrectly = false;
                }
                
                // 实时更新统计信息
                updateStats();
                
                // 短暂延迟后显示下一题
                setTimeout(() => {
                    if (gameActive) {
                        showNextQuestion();
                    }
                }, 1500);
            }
            
            // 扣除生命值
            function loseLife() {
                lives--;
                updateLives();
                
                if (lives <= 0) {
                    endGame();
                }
            }
            
            // 更新生命值显示
            function updateLives() {
                livesContainer.innerHTML = '';
                for (let i = 0; i < lives; i++) {
                    const heart = document.createElement('i');
                    heart.className = 'fa fa-heart life-icon';
                    livesContainer.appendChild(heart);
                }
                // 显示已失去的生命
                for (let i = lives; i < MAX_LIVES; i++) {
                    const heart = document.createElement('i');
                    heart.className = 'fa fa-heart-o life-icon';
                    livesContainer.appendChild(heart);
                }
            }
            
            // 更新分数
            function updateScore() {
                scoreElement.textContent = score;
                gameStatusElement.textContent = `当前分数: ${score}`;
            }
            
            // 更新统计信息显示
            const TOTAL_QUESTIONS = 25; // 总题数
            
            function updateStats() {
                // 计算准确率基于总题数
                const accuracyRate = TOTAL_QUESTIONS > 0 ? Math.round((correctAnswers / TOTAL_QUESTIONS) * 100) : 0;
                
                // 更新统计数据显示 - 显示当前答对数量/总题数25
                document.getElementById('correct-answers').textContent = correctAnswers;
                document.getElementById('total-questions').textContent = TOTAL_QUESTIONS; // 固定显示为25
                document.getElementById('accuracy-rate').textContent = accuracyRate;
            }
            
            // 结束游戏
            function endGame() {
                gameActive = false;
                
                // 显示最终得分和统计信息
                finalScoreElement.textContent = score;
                
                // 使用统一的统计更新函数
                updateStats();
                
                // 显示游戏结束遮罩
                gameOverOverlay.classList.add('active');
                
                // 禁用开始按钮
                startButton.disabled = false;
            }
            
            // 事件监听
            startButton.addEventListener('click', startGame);
            restartButton.addEventListener('click', resetGame);
            playAgainButton.addEventListener('click', resetGame);
            
            // 确保暗色模式下游戏元素样式正确
            function applyDarkModeStyles() {
                const isDarkMode = document.body.classList.contains('dark-mode');
                
                // 更新游戏容器背景色
                if (isDarkMode) {
                    gameContainer.style.backgroundColor = '#333';
                } else {
                    gameContainer.style.backgroundColor = '#f0f0f0';
                }
            }
            
            // 初始化暗色模式样式
            applyDarkModeStyles();
            
            // 监听暗色模式切换
            document.getElementById('theme-toggle').addEventListener('click', applyDarkModeStyles);
        });
        
        // 添加音乐切换功能
        let audio = null;
        function toggleMusic() {
            // 添加音乐切换功能
            // 如果音频对象不存在，创建它
            if (!audio) {
                audio = new Audio('银月的游戏咖厅.mp3');
                audio.loop = true; // 设置音乐循环播放
            }
            
            const musicIcon = document.getElementById('musicIcon');
            if (musicIcon.classList.contains('fa-music')) {
                musicIcon.classList.remove('fa-music');
                musicIcon.classList.add('fa-pause');
                // 播放音乐
                audio.play().catch(error => {
                    console.log('播放音乐时出错:', error);
                });
            } else {
                musicIcon.classList.remove('fa-pause');
                musicIcon.classList.add('fa-music');
                // 暂停音乐
                audio.pause();
            }
        }

        // 添加夜间模式切换功能
        document.getElementById('theme-toggle').addEventListener('click', function() {
            const body = document.body;
            const dayBg = document.getElementById('day-bg');
            const nightBg = document.getElementById('night-bg');
            const sun = document.getElementById('sun');
            const moon = document.getElementById('moon');
            const toggleIcon = document.getElementById('toggle-icon');
            
            // 切换暗色模式类
            body.classList.toggle('dark-mode');
            
            // 切换背景和图标
            if (body.classList.contains('dark-mode')) {
                dayBg.style.opacity = '0';
                nightBg.style.opacity = '1';
                sun.style.opacity = '0';
                moon.style.opacity = '1';
                toggleIcon.style.transform = 'translateX(78px)'; // 增加移动距离到30px，确保月亮完全移动到最右边
            } else {
                dayBg.style.opacity = '1';
                nightBg.style.opacity = '0';
                sun.style.opacity = '1';
                moon.style.opacity = '0';
                toggleIcon.style.transform = 'translateX(0)';
            }
        });
    </script>
</body>
</html>
